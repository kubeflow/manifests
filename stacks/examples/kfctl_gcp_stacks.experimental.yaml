# An experimental example file for using KFDef with the new specs
apiVersion: kfdef.apps.kubeflow.org/v1
kind: KfDef
metadata:
  namespace: kubeflow
spec:
  applications:
  # TODO(jlewi): This should be replaced by ACM when its ready.
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: istio/gcp
    name: stack
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: stacks/gcp
    name: stack
  plugins:
  # TODO(jlewi): The plugin is currently commented out because we don't want to run the
  # generate logic
  - kind: KfGcpPlugin
   metadata:
     creationTimestamp: null
     name: gcp
   spec:
     createPipelinePersistentStorage: true
     deploymentManagerConfig:
       repoRef:
         name: manifests
         path: gcp/deployment_manager_configs
     enableWorkloadIdentity: true
     skipInitProject: true
     useBasicAuth: false
  repos:
  - name: manifests
    uri: https://github.com/jlewi/manifests/archive/stacks.tar.gz    
  version: master
