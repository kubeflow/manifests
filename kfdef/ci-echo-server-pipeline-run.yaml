apiVersion: kfdef.apps.kubeflow.org/v1alpha1
kind: KfDef
metadata:
  name: kubeflow_app
  namespace: kubeflow-ci
spec:
  repos:
  - name: manifests
    root: 
    uri: https://github.com/kubeflow/manifests/archive/pull/328/head.tar.gz
  - name: kubeflow
    root: kubeflow-master
    uri: https://github.com/kubeflow/kubeflow/archive/master.tar.gz
  applications:
  - kustomizeConfig:
      overlays:
      - build-push-task
      - update-manifests-task
      parameters:
      - name: pipeline
        value: ci-pipeline
      - name: image_name
        value: echo-server
      - name: docker_target
        value: serve
      - name: path_to_context
        value: components/echo-server
      - name: path_to_docker_file
        value: components/echo-server/Dockerfile
      - name: path_to_manifests_kustomization_file
        value: common/echo-server
      - name: path_to_manifests_tests_dir
        value: tests
      - name: container_image
        value: "gcr.io/constant-cubist-173123/test-worker@sha256:6258613836e9e5cb4468a3c8841026af9fb3272b39b16fa3f8b2af3cf1d0f350"
      repoRef:
        name: manifests
        path: ci/ci-pipeline
    name: ci-pipeline
  - kustomizeConfig:
      overlays:
      - application
      - kubeflow-repo-resource
      - manifests-repo-resource
      - image-resource
      parameters:
      - name: generateName
        value: ci-pipeline-run-
      - name: pipeline
        value: ci-pipeline
      - name: image_name
        value: echo-server
      - name: image_url
        value: "gcr.io/constant-cubist-173123/echo-server"
      - name: kubeflow_repo_revision
        value: pull/4091/head
      - name: kubeflow_repo_url
        value: https://github.com/kubeflow/kubeflow
      - name: kfctl_image
        value: "gcr.io/constant-cubist-173123/kfctl@sha256:ab0c4986322e3e6a755056278c7270983b0f3bdc0751aefff075fb2b3d0c3254"
      - name: pvc_mount_path
        value: /kubeflow
      - name: project
        value: constant-cubist-173123
      repoRef:
        name: manifests
        path: ci/ci-pipeline-run
    name: ci-pipeline-run
  enableApplications: true
  packageManager: kustomize
  skipInitProject: true
  useBasicAuth: false
  useIstio: false
  version: master
