apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: auth
resources:
- ../../../../dex-auth/dex-crds/base_v3
- ../../../../dex-auth/dex-crds/overlays/istio/virtual-service.yaml
configMapGenerator:
- name: dex-config
  behavior: merge
  literals:
  - issuer="http://dex.auth.svc.cluster.local:5556/dex"
  - oidc_redirect_uris=["/login/oidc"]
  - client_id="kubeflow-oidc-authservice"
  - namespace=auth
  - static_email=admin@example.com
  - static_password_hash=$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W
generatorOptions:
  disableNameSuffixHash: true
vars:
- name: namespace
  objref:
    kind: ConfigMap
    name: dex-config
    apiVersion: v1
  fieldref:
    fieldpath: data.namespace
configurations:
- ../../../../dex-auth/dex-crds/overlays/istio/params.yaml
